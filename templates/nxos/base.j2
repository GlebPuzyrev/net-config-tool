! --- [Section 1.2.7] Disable the Telnet Feature (Level 1) ---
no feature telnet

! --- [Section 1.2.2] Configure IP Blocking on Failed Logins (Level 1) ---
! Block login for 120s if 5 failed attempts occur within 120s
system login block-for 120 attempts 5 within 120

! --- [Section 1.2.3] Limit SSH Login Attempts to 3 or less (Level 1) ---
ssh login-attempts 3

! --- [Section 1.2.4 & 1.2.5] Ensure Exec Timeout is less than 10 (Level 1) ---
line console
  exec-timeout 10
line vty
  exec-timeout 5
! --- [Section 1.2.6] Set the Maximum Number of VTY Sessions (Level 1) ---
  session-limit 5 

! --- ACL for VTY access
ip access-list ACL-VTY-ACCESS
  10 permit ip 10.10.10.10/32 any 

! --- [Section 1.2.1] Restrict Access to VTY Sessions (Level 1) ---
line vty
!  enable if ACL VTY configured
!  access-class ACL-VTY-ACCESS in

! --- [Section 1.3.1] Pre-authentication Banner (Level 1) ---
banner motd ^Authorized Access Only. All activity is monitored.^

! --- [Section 1.4.1] Enable Password Complexity Requirements (Level 1) ---
password strength-check

! --- [Section 1.4.4] Set password length for local credentials (Level 1) ---
userpassphrase min-length 20
userpassphrase max-length 127

! --- [Section 1.6.1] Configure at least 2 external NTP Servers (Level 1) ---
ntp server {{ ntp_server1 }} use-vrf management
ntp server {{ ntp_server2 }} use-vrf management
! Source NTP from a stable interface
ntp source-interface mgmt0

! --- [Section 1.6.4] Configure NTP Authentication (Level 2) ---
!ntp authenticate

! -- Clock Timezone ACST
clock timezone ACST 9 30
clock summer-time ACDT 5 Sun Oct 2:00 1 Sun Apr 3:00 60

! --- [Section 1.5.1] Ensure Syslog Logging is configured (Level 2) ---
logging console 7
logging server {{ logging_server }} 5 use-vrf management

! --- [Section 1.5.4] Configure Logging Timestamps (Level 1) ---
logging timestamp milliseconds

! --- [Section 1.5.2] Log all Successful and Failed Administrative Logins (Level 2) ---
logging level authpriv 5

! --- [Section 1.7.1] Disable Power on Auto Provisioning (POAP) (Level 2) ---
no boot poap enable

! --- [Section 1.7.2] Disable iPXE (Level 2) ---
boot order bootflash

! --- [Section 1.7.3] Set SSH Key Modulus Length (Level 2) ---
! Note: Run this only if current keys are weak (<2048 bits)
! ssh key rsa 2048 force

! --- [Section 1.9.1] Configure SNMPv3 (Level 1) ---
! Enforce encryption for SNMP
snmp-server globalEnforcePriv
! Create v3 user with Auth (SHA) and Priv (AES)
snmp-server user adminUser network-admin auth sha YourAuthPass priv aes-128 YourPrivPass

! --- [Section 2.1.1] Configure Control Plane Policing (Level 1) ---
copp profile strict

